services:
  ai500bot:
    build: .
    container_name: ai500bot
    env_file:
      - .env
    environment:
      CALL_SERVICE_URL: http://call_service:8082
    volumes:
      # Mount session files so interactive logins are picked up without rebuilding the image
      - ./bot.session:/app/bot.session
      - ./interactive_call_session.session:/app/interactive_call_session.session
    ports:
      - "127.0.0.1:8081:8081"
    restart: unless-stopped
    networks:
      - lumipass-net

  call_service:
    build: .
    container_name: call_service
    env_file:
      - .env
    environment:
      CALL_SERVICE_HOST: 0.0.0.0
      CALL_SERVICE_PORT: 8082
      CALL_SESSION_NAME: /app/call_sessions/interactive_call_session.session
    volumes:
      - ./call_sessions:/app/call_sessions
    command: ["python", "-m", "call_service.server"]
    ports:
      - "127.0.0.1:8082:8082"
    restart: unless-stopped
    networks:
      - lumipass-net

networks:
  lumipass-net:
    external: true
